DDD作为设计微服务的主流方法，经过战略和战术建模后会产生聚合、限界上下文等。经过DDD设计的微服务，通常是高内聚、低偶合，并具有演进式架构的特征。今天我们分析一下，经过DDD设计后的微服务，其内部的各种边界。

![image-20211027123720019](../../java_architect/images/mysql/ddd_eventstorm.png)

# 1. 微服务中的几种边界

回顾一下DDD的设计过程。在事件风暴中，团队会梳理出业务中的事件、命令、领域名词等，根据这些会进一步梳理出实体、值对象等领域对象。根据实体与实体、实体与值对象之间的关联关系，将这些紧密相关的领域对象组合成聚合。再根据业务和其他的划分条件（如变化频率）将这些聚合组成不同的限界上下文，形成领域模型。为了方便DDD的落地，在实现上会采用DDD的四层代码分层架构。

我们将聚合称为**逻辑边界**，限界上下文称为**物理边界**，四层架构称为**代码边界**。

逻辑边界：聚合形成了逻辑边界，在逻辑边界内由聚合根维护数据的一致性，在逻辑边界间通过聚合根进行通信。

物理边界：限界上下文构成了物理边界，一个限界上下文包括1到多个聚合（即逻辑边界），限界上下文间采用Restful 或GRPC进行通信。

代码边界：DDD的四层架构形成了代码边界，通过依赖倒置使得领域层不依赖于任何其他层，层与层之间只能上层依赖下层，每一层都有固定的职责。

# 2.为什么这几种边界

